import{d as G,e as W,h as z,j as H,l as K}from"./chunk-PAS32UQI.js";import{r as $,s as B}from"./chunk-VNBHRZ5R.js";import{a as U,b as V,c as j}from"./chunk-4UJSBPAV.js";import{D as s,Fa as F,Ga as N,Ha as O,I as p,K as m,La as L,N as g,Na as P,R as i,S as r,T as l,Ua as T,X as R,Y as x,Ya as k,Z as d,_a as h,ea as o,fa as c,ga as u,ha as D,n as v,p as w,q as M,r as y,u as S,ua as I,v as A,wa as E}from"./chunk-OBJ3TPWI.js";function Z(a,t){if(a&1&&(i(0,"p",23),o(1),r()),a&2){let e=d();s(),D(" Logged in as: ",e.currentUser.email," (",e.currentUser.role,") ")}}function q(a,t){if(a&1&&(i(0,"div",42)(1,"h5",43),o(2),r(),i(3,"div",44)(4,"div",45),l(5,"i",46),i(6,"span"),o(7,"Read"),r()(),i(8,"div",45),l(9,"i",46),i(10,"span"),o(11,"Write"),r()(),i(12,"div",45),l(13,"i",46),i(14,"span"),o(15,"Delete"),r()(),i(16,"div",45),l(17,"i",46),i(18,"span"),o(19,"Export"),r()()()()),a&2){let e=t.$implicit,n=d(2);s(2),c(e.key),s(3),g(n.getPermissionIcon(n.getModulePermissions(e).read)),s(4),g(n.getPermissionIcon(n.getModulePermissions(e).write)),s(4),g(n.getPermissionIcon(n.getModulePermissions(e).delete)),s(4),g(n.getPermissionIcon(n.getModulePermissions(e).export))}}function Y(a,t){if(a&1&&(i(0,"div",45)(1,"span",47),o(2),r(),i(3,"span",48),o(4),r()()),a&2){let e=t.$implicit,n=d(2);s(2),u("",n.formatFieldName(e.key),":"),s(),g(n.getAccessLevelColor(n.getFieldValue(e))),s(),u(" ",n.getFieldValue(e)," ")}}function Q(a,t){if(a&1){let e=R();i(0,"div",24)(1,"div",25)(2,"div")(3,"h3",26),o(4),r(),i(5,"p",27),o(6),r(),i(7,"div",28)(8,"span",29),o(9),r(),i(10,"span",30),o(11),I(12,"date"),r()()(),i(13,"div",31)(14,"button",32),x("click",function(){let f=S(e).$implicit,_=d();return A(_.editRole(f.id))}),l(15,"i",33),o(16,"Edit "),r(),i(17,"button",34),x("click",function(){let f=S(e).$implicit,_=d();return A(_.cloneRole(f.id))}),l(18,"i",35),o(19,"Clone "),r()()(),i(20,"div",36)(21,"h4",37),o(22,"Module Permissions"),r(),i(23,"div",38),p(24,q,20,9,"div",39),r()(),i(25,"div")(26,"h4",37),o(27,"Field-Level Access"),r(),i(28,"div",40),p(29,Y,5,4,"div",41),r()()()}if(a&2){let e=t.$implicit,n=d();s(4),c(e.name),s(2),c(e.description),s(3),u("",n.formatNumber(e.userCount)," users"),s(2),u("Modified: ",E(12,6,e.lastModified,"shortDate"),""),s(13),m("ngForOf",n.getModuleEntries(e.permissions)),s(5),m("ngForOf",n.getFieldEntries(e.fieldLevelAccess))}}function ee(a,t){if(a&1&&(i(0,"div"),o(1),r()),a&2){let e=d().$implicit;s(),c(e.details)}}function te(a,t){if(a&1&&(i(0,"div",49)(1,"div",50)(2,"div",51)(3,"div",52)(4,"span",53),o(5),r(),i(6,"span",54),o(7),r()(),i(8,"div",55)(9,"div"),o(10),r(),i(11,"div"),o(12),r(),i(13,"div"),o(14),I(15,"date"),r(),i(16,"div"),o(17),r(),p(18,ee,2,1,"div",56),r()()()()),a&2){let e=t.$implicit,n=d();s(5),c(e.userName),s(),m("ngClass",n.getLogStatusColor(e.success)),s(),u(" ",e.success?"Success":"Failed"," "),s(3),c(e.action),s(2),c(e.resource),s(2),c(E(15,8,e.timestamp,"medium")),s(3),u("IP: ",e.ipAddress,""),s(),m("ngIf",e.details)}}var C=class a{titleService=w(T);router=w(k);currentUser=null;selectedRole="all";userRoles=[{id:"ROLE-001",name:"Super Admin",description:"Full system access with all permissions",permissions:{practitioners:{read:!0,write:!0,delete:!0,export:!0},facilities:{read:!0,write:!0,delete:!0,export:!0},investigations:{read:!0,write:!0,delete:!0,export:!0},analytics:{read:!0,write:!0,delete:!0,export:!0},communications:{read:!0,write:!0,delete:!0,export:!0},governance:{read:!0,write:!0,delete:!0,export:!0}},fieldLevelAccess:{nationalId:"full",personalData:"full",medicalHistory:"full",financialData:"full",investigationNotes:"full"},userCount:3,lastModified:new Date("2024-12-15"),modifiedBy:"System Administrator"},{id:"ROLE-002",name:"Council Admin",description:"Administrative access for regulatory council operations",permissions:{practitioners:{read:!0,write:!0,delete:!1,export:!0},facilities:{read:!0,write:!0,delete:!1,export:!0},investigations:{read:!0,write:!0,delete:!1,export:!1},analytics:{read:!0,write:!1,delete:!1,export:!0},communications:{read:!0,write:!0,delete:!1,export:!1},governance:{read:!0,write:!1,delete:!1,export:!1}},fieldLevelAccess:{nationalId:"masked",personalData:"full",medicalHistory:"full",financialData:"masked",investigationNotes:"full"},userCount:12,lastModified:new Date("2024-11-20"),modifiedBy:"Super Admin - Dr. Sarah Kiggundu"},{id:"ROLE-003",name:"Inspector",description:"Field inspection and investigation access",permissions:{practitioners:{read:!0,write:!0,delete:!1,export:!1},facilities:{read:!0,write:!0,delete:!1,export:!1},investigations:{read:!0,write:!0,delete:!1,export:!1},analytics:{read:!0,write:!1,delete:!1,export:!1},communications:{read:!1,write:!1,delete:!1,export:!1},governance:{read:!1,write:!1,delete:!1,export:!1}},fieldLevelAccess:{nationalId:"masked",personalData:"full",medicalHistory:"full",financialData:"denied",investigationNotes:"full"},userCount:8,lastModified:new Date("2024-10-10"),modifiedBy:"Council Admin - Dr. James Mukasa"},{id:"ROLE-004",name:"Analyst",description:"Read-only access for data analysis and reporting",permissions:{practitioners:{read:!0,write:!1,delete:!1,export:!0},facilities:{read:!0,write:!1,delete:!1,export:!0},investigations:{read:!0,write:!1,delete:!1,export:!0},analytics:{read:!0,write:!1,delete:!1,export:!0},communications:{read:!0,write:!1,delete:!1,export:!1},governance:{read:!0,write:!1,delete:!1,export:!1}},fieldLevelAccess:{nationalId:"denied",personalData:"masked",medicalHistory:"masked",financialData:"denied",investigationNotes:"masked"},userCount:15,lastModified:new Date("2024-09-05"),modifiedBy:"Council Admin - Patricia Nakato"}];recentAccessLogs=[{id:"LOG-001",userId:"USR-001",userName:"Dr. Sarah Kiggundu",action:"VIEW_PRACTITIONER_DETAILS",resource:"Practitioner: UMC-UG-2458",timestamp:new Date("2025-01-15T14:30:00"),ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",success:!0},{id:"LOG-002",userId:"USR-002",userName:"Inspector David Kiggundu",action:"SUSPEND_LICENSE",resource:"License: UMC-UG-4521",timestamp:new Date("2025-01-15T11:45:00"),ipAddress:"10.0.0.50",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36",success:!0,details:"Reason: Failure to complete CPD requirements"},{id:"LOG-003",userId:"USR-003",userName:"Analyst Patricia Nakato",action:"EXPORT_PRACTITIONER_DATA",resource:"Practitioners: Central Region",timestamp:new Date("2025-01-15T09:15:00"),ipAddress:"172.16.0.25",userAgent:"Mozilla/5.0 (Ubuntu; Linux x86_64) AppleWebKit/537.36",success:!0,details:"Export format: CSV, Records: 2,847"},{id:"LOG-004",userId:"USR-004",userName:"Unknown User",action:"UNAUTHORIZED_ACCESS_ATTEMPT",resource:"Investigation Case: INV-2025-001",timestamp:new Date("2025-01-15T08:30:00"),ipAddress:"203.0.113.45",userAgent:"curl/7.68.0",success:!1,details:"Access denied: Insufficient permissions"}];filteredRoles=[];ngOnInit(){window.scrollTo({top:0,behavior:"smooth"});let t=localStorage.getItem("isLoggedIn"),e=localStorage.getItem("currentUser");if(!t||!e){this.router.navigate(["/login"]);return}if(this.currentUser=JSON.parse(e),this.currentUser.role!=="admin"){alert("Access denied. This portal is restricted to government officials and regulators."),this.router.navigate(["/dashboard"]);return}this.titleService.setTitle("Access Controls - Data Governance"),this.applyFilters()}applyFilters(){this.filteredRoles=this.userRoles.filter(t=>this.selectedRole==="all"||t.id===this.selectedRole)}onRoleChange(t){this.selectedRole=t,this.applyFilters()}createRole(){alert("Opening role creation wizard...")}editRole(t){alert(`Editing role: ${t}`)}cloneRole(t){alert(`Cloning role: ${t}`)}getPermissionIcon(t){return t?"ri-check-line text-green-600":"ri-close-line text-red-600"}getAccessLevelColor(t){switch(t){case"full":return"bg-green-100 text-green-800";case"masked":return"bg-yellow-100 text-yellow-800";case"denied":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}getLogStatusColor(t){return t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}formatNumber(t){return new Intl.NumberFormat("en-UG").format(t)}getModuleEntries(t){return Object.entries(t).map(([e,n])=>({key:e,value:n}))}getFieldEntries(t){return Object.entries(t).map(([e,n])=>({key:e,value:n}))}getModulePermissions(t){return t.value}getFieldValue(t){return t.value}formatFieldName(t){return t.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}logout(){localStorage.removeItem("isLoggedIn"),localStorage.removeItem("currentUser"),this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=M({type:a,selectors:[["app-access-controls"]],decls:36,vars:3,consts:[[1,"bg-white","min-h-screen"],[1,"bg-gradient-to-r","from-gray-700","to-gray-900","py-6"],[1,"container","mx-auto","px-4"],[1,"flex","flex-col","md:flex-row","items-start","md:items-center","justify-between"],[1,"text-2xl","font-bold","text-white","mb-1"],[1,"text-gray-300"],["class","text-gray-400 text-sm mt-1",4,"ngIf"],[1,"flex","items-center","space-x-3","mt-4","md:mt-0"],[1,"bg-white","text-gray-700","px-4","py-2","rounded-lg","hover:bg-gray-50","transition","font-medium","text-sm",3,"click"],[1,"ri-add-line","mr-2"],[1,"bg-red-500","text-white","px-4","py-2","rounded-lg","hover:bg-red-600","transition","font-medium","text-sm",3,"click"],[1,"ri-logout-box-line","mr-2"],[1,"py-6"],[1,"grid","lg:grid-cols-3","gap-8"],[1,"lg:col-span-2"],[1,"bg-white","rounded-lg","shadow-sm","border"],[1,"p-6","border-b","border-gray-200"],[1,"text-xl","font-semibold","text-gray-800"],[1,"divide-y","divide-gray-200"],["class","p-6",4,"ngFor","ngForOf"],[1,"text-lg","font-semibold","text-gray-800"],[1,"divide-y","divide-gray-200","max-h-96","overflow-y-auto"],["class","p-4",4,"ngFor","ngForOf"],[1,"text-gray-400","text-sm","mt-1"],[1,"p-6"],[1,"flex","items-center","justify-between","mb-4"],[1,"font-semibold","text-gray-800"],[1,"text-sm","text-gray-600"],[1,"flex","items-center","mt-2"],[1,"text-xs","text-gray-500","mr-4"],[1,"text-xs","text-gray-500"],[1,"flex","space-x-2"],[1,"bg-blue-500","text-white","px-3","py-1","rounded","text-xs","hover:bg-blue-600","transition",3,"click"],[1,"ri-edit-line","mr-1"],[1,"bg-gray-500","text-white","px-3","py-1","rounded","text-xs","hover:bg-gray-600","transition",3,"click"],[1,"ri-file-copy-line","mr-1"],[1,"mb-4"],[1,"font-medium","text-gray-800","mb-3"],[1,"grid","md:grid-cols-2","gap-4"],["class","bg-gray-50 rounded-lg p-3",4,"ngFor","ngForOf"],[1,"flex","flex-wrap","gap-2"],["class","flex items-center",4,"ngFor","ngForOf"],[1,"bg-gray-50","rounded-lg","p-3"],[1,"font-medium","text-gray-800","mb-2","capitalize"],[1,"grid","grid-cols-4","gap-2","text-xs"],[1,"flex","items-center"],[1,"mr-1"],[1,"text-sm","text-gray-600","mr-2","capitalize"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium"],[1,"p-4"],[1,"flex","items-start","justify-between"],[1,"flex-1"],[1,"flex","items-center","mb-1"],[1,"font-medium","text-gray-800","text-sm","mr-2"],[1,"inline-flex","items-center","px-2","py-1","rounded-full","text-xs","font-medium",3,"ngClass"],[1,"text-xs","text-gray-600","space-y-1"],[4,"ngIf"]],template:function(e,n){e&1&&(i(0,"div",0),l(1,"app-header"),i(2,"section",1)(3,"div",2)(4,"div",3)(5,"div")(6,"h1",4),o(7,"Access Controls"),r(),i(8,"p",5),o(9,"Manage user roles, permissions, and field-level access"),r(),p(10,Z,2,2,"p",6),r(),i(11,"div",7)(12,"button",8),x("click",function(){return n.createRole()}),l(13,"i",9),o(14," Create Role "),r(),i(15,"button",10),x("click",function(){return n.logout()}),l(16,"i",11),o(17," Logout "),r()()()()(),i(18,"section",12)(19,"div",2)(20,"div",13)(21,"div",14)(22,"div",15)(23,"div",16)(24,"h2",17),o(25,"User Roles & Permissions"),r()(),i(26,"div",18),p(27,Q,30,9,"div",19),r()()(),i(28,"div")(29,"div",15)(30,"div",16)(31,"h3",20),o(32,"Recent Access Logs"),r()(),i(33,"div",21),p(34,te,19,11,"div",22),r()()()()()(),l(35,"app-footer"),r()),e&2&&(s(10),m("ngIf",n.currentUser),s(17),m("ngForOf",n.filteredRoles),s(7),m("ngForOf",n.recentAccessLogs))},dependencies:[F,N,O,U,V,L],styles:[".role-card[_ngcontent-%COMP%]{transition:all .3s ease}.role-card[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.permission-grid[_ngcontent-%COMP%], .access-log[_ngcontent-%COMP%]{transition:all .3s ease}.access-log[_ngcontent-%COMP%]:hover{background-color:#3b82f605}"]})};var ie=[{path:"",redirectTo:"access-controls",pathMatch:"full"},{path:"access-controls",component:C}],b=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=y({type:a});static \u0275inj=v({imports:[h.forChild(ie),h]})};var X=class a{static \u0275fac=function(e){return new(e||a)};static \u0275mod=y({type:a});static \u0275inj=v({imports:[P,$,B,W,G,z,K,H,b,j]})};export{X as DataGovernanceModule};
