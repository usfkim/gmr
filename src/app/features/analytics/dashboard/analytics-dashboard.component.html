<!-- Analytics Dashboard -->
<div class="bg-white min-h-screen">
    <!-- Header Navigation -->
    <app-header />
    
    <!-- Analytics Header -->
    <section class="bg-gradient-to-r from-indigo-600 to-purple-700 py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row items-start md:items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-white mb-2">Analytics Dashboard</h1>
                    <p class="text-indigo-100">Comprehensive healthcare workforce analytics and insights</p>
                    <p class="text-indigo-200 text-sm mt-1" *ngIf="currentUser">
                        Logged in as: {{ currentUser.email }} ({{ currentUser.role }})
                    </p>
                </div>
                <div class="flex items-center space-x-3 mt-4 md:mt-0">
                    <div class="flex items-center space-x-2">
                        <label class="text-white text-sm">Timeframe:</label>
                        <select (change)="onTimeframeChange($any($event.target).value)" 
                                class="bg-white text-gray-800 px-3 py-1 rounded-lg text-sm">
                            <option value="7">Last 7 days</option>
                            <option value="30" selected>Last 30 days</option>
                            <option value="90">Last 90 days</option>
                            <option value="365">Last year</option>
                        </select>
                    </div>
                    <button (click)="logout()" 
                            class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition font-medium text-sm">
                        <i class="ri-logout-box-line mr-2"></i>
                        Logout
                    </button>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Quick Metrics Overview -->
    <section class="py-8 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div *ngFor="let metric of quickMetrics" 
                     class="bg-white rounded-lg shadow-sm p-6 border-l-4 hover:shadow-md transition-shadow cursor-pointer"
                     [class]="getCardColor(metric.color)"
                     (click)="router.navigate([metric.route])">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">{{ metric.title }}</p>
                            <p class="text-2xl font-bold text-gray-900">{{ metric.value }}</p>
                            <div class="flex items-center mt-1">
                                <i [class]="getTrendIcon(metric.trend)" class="text-sm mr-1"></i>
                                <span class="text-xs font-medium" 
                                      [class]="metric.trend === 'up' ? 'text-green-600' : metric.trend === 'down' ? 'text-red-600' : 'text-gray-600'">
                                    {{ metric.change > 0 ? '+' : '' }}{{ metric.change.toFixed(1) }}%
                                </span>
                            </div>
                        </div>
                        <div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center">
                            <i [class]="metric.icon + ' ' + getIconColor(metric.color)" class="text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Analytics Categories -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Workforce Analytics -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-team-line text-blue-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Workforce Analytics</h3>
                            <p class="text-sm text-gray-600">Density, distribution, and gaps</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/workforce-density" 
                           class="block text-sm text-blue-600 hover:text-blue-800 transition">
                            → Workforce Density per 10k Population
                        </a>
                        <a routerLink="/analytics/access-gaps" 
                           class="block text-sm text-blue-600 hover:text-blue-800 transition">
                            → Access Gaps & AI Predictions
                        </a>
                    </div>
                </div>

                <!-- Training & Pipeline -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-graduation-cap-line text-green-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Training Pipeline</h3>
                            <p class="text-sm text-gray-600">Education and capacity planning</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/training-pipeline" 
                           class="block text-sm text-green-600 hover:text-green-800 transition">
                            → Graduates vs. Needs Analysis
                        </a>
                        <a routerLink="/analytics/training-pipeline" 
                           class="block text-sm text-green-600 hover:text-green-800 transition">
                            → Residency Slots & Internships
                        </a>
                    </div>
                </div>

                <!-- Migration & Attrition -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-flight-takeoff-line text-orange-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Migration Analytics</h3>
                            <p class="text-sm text-gray-600">Attrition and movement patterns</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/attrition-migration" 
                           class="block text-sm text-orange-600 hover:text-orange-800 transition">
                            → Departures by Destination
                        </a>
                        <a routerLink="/analytics/attrition-migration" 
                           class="block text-sm text-orange-600 hover:text-orange-800 transition">
                            → Specialty Migration Patterns
                        </a>
                    </div>
                </div>

                <!-- Fraud Detection -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-shield-cross-line text-red-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Fraud Analytics</h3>
                            <p class="text-sm text-gray-600">Detection and prevention</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/fraud-heatmap" 
                           class="block text-sm text-red-600 hover:text-red-800 transition">
                            → Fraud Heatmap & Patterns
                        </a>
                        <a routerLink="/analytics/fraud-heatmap" 
                           class="block text-sm text-red-600 hover:text-red-800 transition">
                            → Source Pattern Analysis
                        </a>
                    </div>
                </div>

                <!-- Compliance Monitoring -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-line-chart-line text-purple-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Compliance Curves</h3>
                            <p class="text-sm text-gray-600">CPD and renewal tracking</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/compliance-curves" 
                           class="block text-sm text-purple-600 hover:text-purple-800 transition">
                            → CPD Completion Trends
                        </a>
                        <a routerLink="/analytics/compliance-curves" 
                           class="block text-sm text-purple-600 hover:text-purple-800 transition">
                            → Renewal Timeliness Analysis
                        </a>
                    </div>
                </div>

                <!-- Revenue Analytics -->
                <div class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-shadow">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-emerald-100 rounded-full flex items-center justify-center mr-4">
                            <i class="ri-bar-chart-line text-emerald-600 text-xl"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold text-gray-800">Revenue Dashboard</h3>
                            <p class="text-sm text-gray-600">Financial analytics</p>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <a routerLink="/analytics/revenue-dashboard" 
                           class="block text-sm text-emerald-600 hover:text-emerald-800 transition">
                            → Fees by Category
                        </a>
                        <a routerLink="/analytics/revenue-dashboard" 
                           class="block text-sm text-emerald-600 hover:text-emerald-800 transition">
                            → Embassy & API Revenue
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Recent Analytics Insights -->
    <section class="py-8">
        <div class="container mx-auto px-4">
            <div class="bg-white rounded-lg shadow-sm border p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-6">Recent Insights</h2>
                
                <div class="grid lg:grid-cols-2 gap-8">
                    <!-- Key Findings -->
                    <div>
                        <h3 class="font-medium text-gray-800 mb-4">Key Findings</h3>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 mr-3"></div>
                                <div>
                                    <p class="text-sm text-gray-800 font-medium">Workforce density improved by 2.3% in Central region</p>
                                    <p class="text-xs text-gray-600">Driven by new medical school graduates and retention programs</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-2 h-2 bg-green-500 rounded-full mt-2 mr-3"></div>
                                <div>
                                    <p class="text-sm text-gray-800 font-medium">Fraud cases decreased by 5% this month</p>
                                    <p class="text-xs text-gray-600">Enhanced verification systems showing positive impact</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-2 h-2 bg-orange-500 rounded-full mt-2 mr-3"></div>
                                <div>
                                    <p class="text-sm text-gray-800 font-medium">12 regions still lack specialist coverage</p>
                                    <p class="text-xs text-gray-600">AI models predict critical shortages in cardiology and anesthesiology</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="w-2 h-2 bg-purple-500 rounded-full mt-2 mr-3"></div>
                                <div>
                                    <p class="text-sm text-gray-800 font-medium">CPD compliance rate reached 85.7%</p>
                                    <p class="text-xs text-gray-600">Highest compliance rate in 3 years due to digital tracking</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recommendations -->
                    <div>
                        <h3 class="font-medium text-gray-800 mb-4">AI Recommendations</h3>
                        <div class="space-y-4">
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h4 class="font-medium text-blue-800 mb-2">Workforce Planning</h4>
                                <p class="text-sm text-blue-700">Increase cardiology fellowship positions by 40% to address projected shortages in Northern and Eastern regions.</p>
                            </div>
                            
                            <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h4 class="font-medium text-green-800 mb-2">Retention Strategy</h4>
                                <p class="text-sm text-green-700">Implement rural incentive packages to reduce migration to urban centers and international destinations.</p>
                            </div>
                            
                            <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                                <h4 class="font-medium text-orange-800 mb-2">Training Pipeline</h4>
                                <p class="text-sm text-orange-700">Expand residency slots by 25% and strengthen partnerships with international training institutions.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <app-footer />
</div>